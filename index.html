<!doctype html>
<html>
<head>
	<title>madeincluj</title>

	 <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.6.4/leaflet.css" />
 <!--[if lte IE 8]>
     <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.6.4/leaflet.ie.css" />
 <![endif]-->
 <link href='http://fonts.googleapis.com/css?family=Lato:400,700,400italic' rel='stylesheet' type='text/css'>

	<style type="text/css">

		body {
			font-family: 'Lato', 'Helvetica', 'Arial', sans-serif;
		}

		#header {
			position:absolute;
			left: 0;
			right: 0;
			top: 0;
			padding: 1em;
			z-index: 2;
		}

		#header h1 {
			font-size: 2em;
			margin: 0;
		}

		#map {
			position:absolute;
			left: 0;
			right: 0;
			top: 0;
			bottom: 0;
			background: #eee;
			z-index: 1;
		}

		#map .leaflet-control-zoom { margin-top: 8em; }

		#map .leaflet-control-attribution a { color: #000; }
	</style>

	<script src="js/lib/leaflet.js"></script>
	<script type="text/javascript" src="js/lib/tile.stamen.js"></script>
  <script type="text/javascript" src="js/lib/OSMBuildings-Leaflet.js"></script>
	<script type="text/javascript" src="js/lib/underscore-min.js"></script>
	<script type="text/javascript" src="js/lib/Leaflet-KML.js"></script>
	<script type="text/javascript" src="js/lib/Leaflet-Google.js"></script>	
	<script src="http://maps.google.com/maps/api/js?v=3&sensor=false"></script>
	<script type="text/javascript">

    var geojson;
    var latoffset = 0.000319661965654916 + 0.000037661515271736334;
    var lngoffset = -0.00035941600799560547 + 0.00006973743438720703;
    function load(data) {
      geojson = data;
      geojson.features.forEach(function(feature) {
        feature.properties.height = 20;
        feature.properties.minHeight = 0;
        if (feature.geometry && feature.geometry.coordinates) {
        	var coords = feature.geometry.coordinates;
        	coords[0].forEach(function(c) {
        		c[0] += latoffset;
        		c[1] += lngoffset;
        		c.length = 2;
        	});
        }
      });

    	// geojson.features = geojson.features.slice(5011, 5013);
    };

		window.onload = function() {
			var map = L.map('map', {
				center: [46.7667, 23.5569],
				zoom: 16,
				minZoom: 13,
				maxZoom: 20,
				maxBounds: new L.LatLngBounds([46.3,23], [47, 24])
			});
			var layer = new L.StamenTileLayer("toner", {

				detectRetina: true
			});	
			// map.addLayer(layer);

			var ggl = new L.Google('ROADMAP');
			map.addLayer(ggl);


			// var track = new L.KML("kml/cluj3D.kml", {async: true});
			// track.on("loaded", function(e) { map.fitBounds(e.target.getBounds()); });
			// map.addLayer(track);

			var osmb = new OSMBuildings(map);

			osmb.setData(geojson).setStyle({
				// shadows: false
			});

			var coords = window.coords = [];
			map.on('click', function(e) {
				coords.push(e.latlng);
			});



		}
	</script>


  <script type="text/javascript" src="geojson/test.json"></script>
</head>
<body>

	<div id='header'>
		<h1><img src='img/logo.png'/> madeincluj</h1>
	</div>
	<div id='map'></div>

</body>
</html>